# Excel处理工作台 - Streamlit前端使用指南

## 🚀 快速启动

### 1. 安装依赖
```bash
pip3 install -r requirements.txt
```

### 2. 启动Web应用
```bash
streamlit run excel_web_app.py
```

### 3. 访问应用
浏览器会自动打开 http://localhost:8501

## 📋 功能特性

### ✅ 完整格式保留
- **字体格式**：字体名称、大小、粗体、斜体、下划线、删除线、颜色
- **背景颜色**：单元格填充色、渐变填充
- **边框格式**：边框样式、颜色、粗细
- **对齐方式**：水平对齐、垂直对齐、文本旋转、自动换行
- **数字格式**：日期格式（yyyy-mm-dd）、货币格式、百分比、千分位
- **列宽行高**：自动复制原始文件的列宽和行高设置
- **合并单元格**：保持原有的单元格合并状态
- **数据验证**：下拉列表、输入限制等
- **超链接**：保持单元格中的超链接

### ✅ 智能处理
- **多工作表支持**：可选择要处理的工作表
- **字段筛选**：可选择保留的字段
- **智能排序**：支持多字段排序
- **批量处理**：支持多个文件同时上传

## 🎯 使用步骤

### 拆分模式
1. 选择"拆分大表为多个小表"
2. 上传主表Excel文件
3. 选择要处理的工作表
4. 选择拆分字段（如：部门）
5. 选择要保留的字段
6. 选择排序字段（可选）
7. 设置输出目录
8. 点击"开始拆分"
9. 下载拆分后的文件

### 合并模式
1. 选择"合并多个小表为大表"
2. 上传多个小表Excel文件
3. 选择要处理的工作表
4. 选择要保留的字段
5. 选择排序字段（可选）
6. 设置输出目录和文件名
7. 点击"开始合并"
8. 下载合并后的文件

## 🧪 测试格式复制

### 创建测试文件
```bash
python3 create_formatted_sample.py
```

这将创建一个包含各种格式的测试文件 `格式测试文件.xlsx`，包括：
- 蓝色表头背景
- 黑色边框
- 日期格式（yyyy-mm-dd）
- 薪资千分位格式
- 高薪红色显示
- 低分黄色背景
- 合并单元格
- 自定义列宽行高

### 测试步骤
1. 运行上述命令创建测试文件
2. 启动Streamlit应用
3. 上传测试文件进行拆分或合并
4. 检查结果文件是否保留了所有格式

## 🔧 高级配置

### 配置文件
您也可以使用JSON或YAML配置文件：

```json
{
  "split_field": "部门",
  "keep_fields": ["员工编号", "姓名", "部门", "职位", "入职日期", "薪资"],
  "sort_fields": ["部门", "姓名"],
  "output_dir": "output",
  "sheet_name": "员工信息",
  "preserve_format": true
}
```

### 命令行模式
```bash
# 拆分
python3 花名册智能处理工具.py --mode split --config config.json --input 格式测试文件.xlsx

# 合并
python3 花名册智能处理工具.py --mode merge --config config.json --input "文件1.xlsx,文件2.xlsx" --output 合并结果.xlsx
```

## 🐛 故障排除

### 常见问题

1. **Streamlit未安装**
   ```bash
   pip3 install streamlit
   ```

2. **端口被占用**
   ```bash
   streamlit run excel_web_app.py --server.port 8502
   ```

3. **格式复制失败**
   - 检查Excel文件是否被其他程序占用
   - 确保文件格式为.xlsx
   - 检查工作表名称是否正确

4. **内存不足**
   - 对于大文件，建议先按其他字段筛选
   - 关闭其他不必要的程序

### 日志查看
- Streamlit应用会在控制台显示实时日志
- 详细日志保存在 `excel_processor.log`

## 📞 技术支持

- **Python版本**：3.7+
- **操作系统**：Windows, macOS, Linux
- **浏览器**：Chrome, Firefox, Safari, Edge

如有问题，请检查：
1. Python环境是否正确
2. 依赖包是否完整安装
3. Excel文件格式是否正确
4. 工作表名称是否存在 